<!DOCTYPE html
  PUBLIC "-//W3C//DTD HTML 4.01//EN">
<html lang="en">
   <head profile="http://dublincore.org/documents/2008/08/04/dc-html/">
      <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
      <title>HTTP State Management Mechanism</title><style type="text/css" title="Xml2Rfc (sans serif)">
a {
  text-decoration: none;
}
a.smpl {
  color: black;
}
a:hover {
  text-decoration: underline;
}
a:active {
  text-decoration: underline;
}
address {
  margin-top: 1em;
  margin-left: 2em;
  font-style: normal;
}
body {
  color: black;
  font-family: cambria, helvetica, arial, sans-serif;
  font-size: 11pt;
  margin-right: 2em;
}
cite {
  font-style: normal;
}
dl {
  margin-left: 2em;
}
ul.empty {
  list-style-type: none;
}
ul.empty li {
  margin-top: .5em;
}
dl p {
  margin-left: 0em;
}
dt {
  margin-top: .5em;
}
h1 {
  font-size: 130%;
  line-height: 21pt;
  page-break-after: avoid;
}
h1.np {
  page-break-before: always;
}
h2 {
  font-size: 120%;
  line-height: 15pt;
  page-break-after: avoid;
}
h3 {
  font-size: 110%;
  page-break-after: avoid;
}
h4, h5, h6 {
  page-break-after: avoid;
}
h1 a, h2 a, h3 a, h4 a, h5 a, h6 a {
  color: black;
}
img {
  margin-left: 3em;
}
li {
  margin-left: 2em;
}
ol {
  margin-left: 2em;
}
ol.la {
  list-style-type: lower-alpha;
}
ol.ua {
  list-style-type: upper-alpha;
}
ol p {
  margin-left: 0em;
}
p {
  margin-left: 2em;
}
pre {
  margin-left: 3em;
  background-color: lightyellow;
  padding: .25em;
  page-break-inside: avoid;
}
pre.text2 {
  border-style: dotted;
  border-width: 1px;
  background-color: #f0f0f0;
  width: 69em;
}
pre.inline {
  background-color: white;
  padding: 0em;
}
pre.text {
  border-style: dotted;
  border-width: 1px;
  background-color: #f8f8f8;
  width: 69em;
}
pre.drawing {
  border-style: solid;
  border-width: 1px;
  background-color: #f8f8f8;
  padding: 2em;
}
table {
  margin-left: 2em;
}
table.header {
  border-spacing: 1px;
  width: 95%;
  font-size: 11pt;
  color: white;
}
td.top {
  vertical-align: top;
}
td.topnowrap {
  vertical-align: top;
  white-space: nowrap;
}
table.header td {
  background-color: gray;
  width: 50%;
}
table.header a {
  color: white;
}
td.reference {
  vertical-align: top;
  white-space: nowrap;
  padding-right: 1em;
}
thead {
  display:table-header-group;
}
ul.toc, ul.toc ul {
  list-style: none;
  margin-left: 1.5em;
  padding-left: 0em;
}
ul.toc li {
  line-height: 150%;
  font-weight: bold;
  margin-left: 0em;
}
ul.toc li li {
  line-height: normal;
  font-weight: normal;
  font-size: 10pt;
  margin-left: 0em;
}
li.excluded {
  font-size: 0pt;
}
ul p {
  margin-left: 0em;
}
.title, .filename, h1, h2, h3, h4 {
  font-family: candara, helvetica, arial, sans-serif;
}
samp, tt, code, pre {
  font: consolas, monospace;
}
ul.ind, ul.ind ul {
  list-style: none;
  margin-left: 1.5em;
  padding-left: 0em;
  page-break-before: avoid;
}
ul.ind li {
  font-weight: bold;
  line-height: 200%;
  margin-left: 0em;
}
ul.ind li li {
  font-weight: normal;
  line-height: 150%;
  margin-left: 0em;
}
.avoidbreak {
  page-break-inside: avoid;
}
.bcp14 {
  font-style: normal;
  text-transform: lowercase;
  font-variant: small-caps;
}
.comment {
  background-color: yellow;
}
.center {
  text-align: center;
}
.error {
  color: red;
  font-style: italic;
  font-weight: bold;
}
.figure {
  font-weight: bold;
  text-align: center;
  font-size: 10pt;
}
.filename {
  color: #333333;
  font-size: 75%;
  font-weight: bold;
  line-height: 21pt;
  text-align: center;
}
.fn {
  font-weight: bold;
}
.left {
  text-align: left;
}
.right {
  text-align: right;
}
.title {
  color: green;
  font-size: 150%;
  line-height: 18pt;
  font-weight: bold;
  text-align: center;
  margin-top: 36pt;
}
.warning {
  font-size: 130%;
  background-color: yellow;
}


@media print {
  .noprint {
    display: none;
  }

  a {
    color: black;
    text-decoration: none;
  }

  table.header {
    width: 90%;
  }

  td.header {
    width: 50%;
    color: black;
    background-color: white;
    vertical-align: top;
    font-size: 110%;
  }

  ul.toc a:nth-child(2)::after {
    content: leader('.') target-counter(attr(href), page);
  }

  ul.ind li li a {
    content: target-counter(attr(href), page);
  }

  .print2col {
    column-count: 2;
    -moz-column-count: 2;
    column-fill: auto;
  }
}

@page {
  @top-left {
       content: "RFC 2965";
  }
  @top-right {
       content: "October 2000";
  }
  @top-center {
       content: "HTTP State Management Mechanism";
  }
  @bottom-left {
       content: "Kristol & Montulli";
  }
  @bottom-center {
       content: "Standards Track";
  }
  @bottom-right {
       content: "[Page " counter(page) "]";
  }
}

@page:first {
    @top-left {
      content: normal;
    }
    @top-right {
      content: normal;
    }
    @top-center {
      content: normal;
    }
}
</style><link rel="Contents" href="#rfc.toc">
      <link rel="Author" href="#rfc.authors">
      <link rel="Copyright" href="#rfc.copyright">
      <link rel="Index" href="#rfc.index">
      <link rel="Chapter" title="1 TERMINOLOGY" href="#rfc.section.1">
      <link rel="Chapter" title="2 STATE AND SESSIONS" href="#rfc.section.2">
      <link rel="Chapter" title="3 DESCRIPTION" href="#rfc.section.3">
      <link rel="Chapter" title="4 EXAMPLES" href="#rfc.section.4">
      <link rel="Chapter" title="5 IMPLEMENTATION CONSIDERATIONS" href="#rfc.section.5">
      <link rel="Chapter" title="6 PRIVACY" href="#rfc.section.6">
      <link rel="Chapter" title="7 SECURITY CONSIDERATIONS" href="#rfc.section.7">
      <link rel="Chapter" title="8 OTHER, SIMILAR, PROPOSALS" href="#rfc.section.8">
      <link rel="Chapter" title="9 HISTORICAL" href="#rfc.section.9">
      <link rel="Chapter" title="10 ACKNOWLEDGEMENTS" href="#rfc.section.10">
      <link rel="Chapter" href="#rfc.section.11" title="11 References">
      <link rel="Alternate" title="Authorative ASCII Version" href="http://www.ietf.org/rfc/rfc2965.txt">
      <link rel="Help" title="RFC-Editor's Status Page" href="http://www.rfc-editor.org/info/rfc2965">
      <link rel="Help" title="Additional Information on tools.ietf.org" href="http://tools.ietf.org/html/rfc2965">
      <meta name="generator" content="http://greenbytes.de/tech/webdav/rfc2629.xslt, Revision 1.611, 2013/11/27 12:23:51, XSLT vendor: SAXON 8.9 from Saxonica http://www.saxonica.com/">
      <link rel="schema.dct" href="http://purl.org/dc/terms/">
      <meta name="dct.creator" content="Kristol, D. M.">
      <meta name="dct.creator" content="Montulli, L.">
      <meta name="dct.identifier" content="urn:ietf:rfc:2965">
      <meta name="dct.issued" scheme="ISO8601" content="2000-10">
      <meta name="dct.replaces" content="urn:ietf:rfc:2109">
      <meta name="dct.abstract" content="This document specifies a way to create a stateful session with Hypertext Transfer Protocol (HTTP) requests and responses. It describes three new headers, Cookie, Cookie2, and Set-Cookie2, which carry state information between participating origin servers and user agents. The method described here differs from Netscape's Cookie proposal , but it can interoperate with HTTP/1.0 user agents that use Netscape's method. (See the HISTORICAL section.) This document reflects implementation experience with RFC 2109 and obsoletes it.">
      <meta name="dct.isPartOf" content="urn:issn:2070-1721">
      <meta name="description" content="This document specifies a way to create a stateful session with Hypertext Transfer Protocol (HTTP) requests and responses. It describes three new headers, Cookie, Cookie2, and Set-Cookie2, which carry state information between participating origin servers and user agents. The method described here differs from Netscape's Cookie proposal , but it can interoperate with HTTP/1.0 user agents that use Netscape's method. (See the HISTORICAL section.) This document reflects implementation experience with RFC 2109 and obsoletes it.">
   </head>
   <body>
      <table class="header">
         <tbody>
            <tr>
               <td class="left">Network Working Group</td>
               <td class="right">D. Kristol</td>
            </tr>
            <tr>
               <td class="left">Request for Comments: 2965</td>
               <td class="right">Bell Laboratories, Lucent Technologies</td>
            </tr>
            <tr>
               <td class="left">Obsoletes: <a href="http://tools.ietf.org/html/rfc2109">2109</a></td>
               <td class="right">L. Montulli</td>
            </tr>
            <tr>
               <td class="left">Category: Standards Track</td>
               <td class="right">Epinions.com, Inc.</td>
            </tr>
            <tr>
               <td class="left"></td>
               <td class="right">October 2000</td>
            </tr>
         </tbody>
      </table>
      <p class="title">HTTP State Management Mechanism</p>
      <div id="rfc.status">
         <h1><a href="#rfc.status">Status of this Memo</a></h1>
         <p>This document specifies an Internet standards track protocol for the Internet community, and requests discussion and suggestions
            for improvements. Please refer to the current edition of the “Internet Official Protocol Standards” (STD 1) for the standardization
            state and status of this protocol. Distribution of this memo is unlimited.
         </p>
      </div>
      <div id="rfc.copyrightnotice">
         <h1><a href="#rfc.copyrightnotice">Copyright Notice</a></h1>
         <p>Copyright © The Internet Society (2000). All Rights Reserved.</p>
      </div>
      <h1 id="rfc.abstract"><a href="#rfc.abstract">Abstract</a></h1>
      <p>This document specifies a way to create a stateful session with Hypertext Transfer Protocol (HTTP) requests and responses.
         It describes three new headers, Cookie, Cookie2, and Set-Cookie2, which carry state information between participating origin
         servers and user agents. The method described here differs from Netscape's Cookie proposal <a href="#Netscape" id="rfc.xref.Netscape.1"><cite title="Persistent Client State -- HTTP Cookies">[Netscape]</cite></a>, but it can interoperate with HTTP/1.0 user agents that use Netscape's method. (See the HISTORICAL section.)
      </p>
      <p>This document reflects implementation experience with RFC 2109 and obsoletes it.</p>
      <hr class="noprint">
      <h1 class="np" id="rfc.toc"><a href="#rfc.toc">Table of Contents</a></h1>
      <ul class="toc">
         <li><a href="#rfc.section.1">1.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.1">TERMINOLOGY</a><ul>
               <li><a href="#rfc.section.1.1">1.1</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.1.1">Requirements</a></li>
            </ul>
         </li>
         <li><a href="#rfc.section.2">2.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.2">STATE AND SESSIONS</a></li>
         <li><a href="#rfc.section.3">3.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.3">DESCRIPTION</a><ul>
               <li><a href="#rfc.section.3.1">3.1</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.3.1">Syntax: General</a></li>
               <li><a href="#rfc.section.3.2">3.2</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.3.2">Origin Server Role</a><ul>
                     <li><a href="#rfc.section.3.2.1">3.2.1</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.3.2.1">General</a></li>
                     <li><a href="#rfc.section.3.2.2">3.2.2</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.3.2.2">Set-Cookie2 Syntax</a></li>
                     <li><a href="#rfc.section.3.2.3">3.2.3</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.3.2.3">Controlling Caching</a></li>
                  </ul>
               </li>
               <li><a href="#rfc.section.3.3">3.3</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.3.3">User Agent Role</a><ul>
                     <li><a href="#rfc.section.3.3.1">3.3.1</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.3.3.1">Interpreting Set-Cookie2</a></li>
                     <li><a href="#rfc.section.3.3.2">3.3.2</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.3.3.2">Rejecting Cookies</a></li>
                     <li><a href="#rfc.section.3.3.3">3.3.3</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.3.3.3">Cookie Management</a></li>
                     <li><a href="#rfc.section.3.3.4">3.3.4</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.3.3.4">Sending Cookies to the Origin Server</a></li>
                     <li><a href="#rfc.section.3.3.5">3.3.5</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.3.3.5">Identifying What Version is Understood:  Cookie2</a></li>
                     <li><a href="#rfc.section.3.3.6">3.3.6</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.3.3.6">Sending Cookies in Unverifiable Transactions</a></li>
                  </ul>
               </li>
               <li><a href="#rfc.section.3.4">3.4</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.3.4">How an Origin Server Interprets the Cookie Header</a></li>
               <li><a href="#rfc.section.3.5">3.5</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.3.5">Caching Proxy Role</a></li>
            </ul>
         </li>
         <li><a href="#rfc.section.4">4.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.4">EXAMPLES</a><ul>
               <li><a href="#rfc.section.4.1">4.1</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.4.1">Example 1</a></li>
               <li><a href="#rfc.section.4.2">4.2</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.4.2">Example 2</a></li>
            </ul>
         </li>
         <li><a href="#rfc.section.5">5.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.5">IMPLEMENTATION CONSIDERATIONS</a><ul>
               <li><a href="#rfc.section.5.1">5.1</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.5.1">Set-Cookie2 Content</a></li>
               <li><a href="#rfc.section.5.2">5.2</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.5.2">Stateless Pages</a></li>
               <li><a href="#rfc.section.5.3">5.3</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.5.3">Implementation Limits</a><ul>
                     <li><a href="#rfc.section.5.3.1">5.3.1</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.5.3.1">Denial of Service Attacks</a></li>
                  </ul>
               </li>
            </ul>
         </li>
         <li><a href="#rfc.section.6">6.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.6">PRIVACY</a><ul>
               <li><a href="#rfc.section.6.1">6.1</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.6.1">User Agent Control</a></li>
               <li><a href="#rfc.section.6.2">6.2</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.6.2">Origin Server Role</a></li>
               <li><a href="#rfc.section.6.3">6.3</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.6.3">Clear Text</a></li>
            </ul>
         </li>
         <li><a href="#rfc.section.7">7.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.7">SECURITY CONSIDERATIONS</a><ul>
               <li><a href="#rfc.section.7.1">7.1</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.7.1">Protocol Design</a></li>
               <li><a href="#rfc.section.7.2">7.2</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.7.2">Cookie Spoofing</a></li>
               <li><a href="#rfc.section.7.3">7.3</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.7.3">Unexpected Cookie Sharing</a></li>
               <li><a href="#rfc.section.7.4">7.4</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.7.4">Cookies For Account Information</a></li>
            </ul>
         </li>
         <li><a href="#rfc.section.8">8.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.8">OTHER, SIMILAR, PROPOSALS</a></li>
         <li><a href="#rfc.section.9">9.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.9">HISTORICAL</a><ul>
               <li><a href="#rfc.section.9.1">9.1</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.9.1">Compatibility with Existing Implementations</a></li>
               <li><a href="#rfc.section.9.2">9.2</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.9.2">Caching and HTTP/1.0</a></li>
            </ul>
         </li>
         <li><a href="#rfc.section.10">10.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.section.10">ACKNOWLEDGEMENTS</a></li>
         <li><a href="#rfc.section.11">11.</a>&nbsp;&nbsp;&nbsp;<a href="#rfc.references">References</a></li>
         <li><a href="#rfc.authors">Authors' Addresses</a></li>
         <li><a href="#rfc.index">Index</a></li>
         <li><a href="#rfc.ipr">Intellectual Property and Copyright Statements</a></li>
      </ul>
      <hr class="noprint">
      <div>
         <h1 id="rfc.section.1" class="np"><a href="#rfc.section.1">1.</a>&nbsp;TERMINOLOGY
         </h1>
         <p id="rfc.section.1.p.1">The terms user agent, client, server, proxy, origin server, and http_URL have the same meaning as in the HTTP/1.1 specification <a href="#RFC2616" id="rfc.xref.RFC2616.1"><cite title="Hypertext Transfer Protocol -- HTTP/1.1">[RFC2616]</cite></a>. The terms abs_path and absoluteURI have the same meaning as in the URI Syntax specification <a href="#RFC2396" id="rfc.xref.RFC2396.1"><cite title="Uniform Resource Identifiers (URI): Generic Syntax">[RFC2396]</cite></a>.
         </p>
         <p id="rfc.section.1.p.2">Host name (HN) means either the host domain name (HDN) or the numeric Internet Protocol (IP) address of a host. The fully
            qualified domain name is preferred; use of numeric IP addresses is strongly discouraged.
         </p>
         <p id="rfc.section.1.p.3">The terms request-host and request-URI refer to the values the client would send to the server as, respectively, the host
            (but not port) and abs_path portions of the absoluteURI (http_URL) of the HTTP request line. Note that request-host is a HN.
         </p>
         <p id="rfc.section.1.p.4">The term effective host name is related to host name. If a host name contains no dots, the effective host name is that name
            with the string .local appended to it. Otherwise the effective host name is the same as the host name. Note that all effective
            host names contain at least one dot.
         </p>
         <p id="rfc.section.1.p.5">The term request-port refers to the port portion of the absoluteURI (http_URL) of the HTTP request line. If the absoluteURI
            has no explicit port, the request-port is the HTTP default, 80. The request-port of a cookie is the request-port of the request
            in which a Set-Cookie2 response header was returned to the user agent.
         </p>
         <p id="rfc.section.1.p.6">Host names can be specified either as an IP address or a HDN string. Sometimes we compare one host name with another. (Such
            comparisons <em class="bcp14">SHALL</em> be case-insensitive.) Host A's name domain-matches host B's if 
         </p>
         <ul>
            <li>their host name strings string-compare equal; or</li>
            <li>A is a HDN string and has the form NB, where N is a non-empty name string, B has the form .B', and B' is a HDN string. (So,
               x.y.com domain-matches .Y.com but not Y.com.)
            </li>
         </ul>
         <p id="rfc.section.1.p.7">Note that domain-match is not a commutative operation: a.b.c.com domain-matches .c.com, but not the reverse.</p>
         <p id="rfc.section.1.p.8">The reach R of a host name H is defined as follows: </p>
         <ul>
            <li>If 
               <ul>
                  <li>H is the host domain name of a host; and,</li>
                  <li>H has the form A.B; and</li>
                  <li>A has no embedded (that is, interior) dots; and</li>
                  <li>B has at least one embedded dot, or B is the string "local". then the reach of H is .B.</li>
               </ul> 
            </li>
            <li>Otherwise, the reach of H is H.</li>
         </ul>
         <p id="rfc.section.1.p.9">For two strings that represent paths, P1 and P2, P1 path-matches P2 if P2 is a prefix of P1 (including the case where P1 and
            P2 string- compare equal). Thus, the string /tec/waldo path-matches /tec.
         </p>
         <p id="rfc.section.1.p.10">Because it was used in Netscape's original implementation of state management, we will use the term cookie to refer to the
            state information that passes between an origin server and user agent, and that gets stored by the user agent.
         </p>
         <div>
            <h2 id="rfc.section.1.1"><a href="#rfc.section.1.1">1.1</a>&nbsp;Requirements
            </h2>
            <p id="rfc.section.1.1.p.1">The key words "MAY", "MUST", "MUST NOT", "OPTIONAL", "RECOMMENDED", "REQUIRED", "SHALL", "SHALL NOT", "SHOULD", "SHOULD NOT"
               in this document are to be interpreted as described in RFC 2119 <a href="#RFC2119" id="rfc.xref.RFC2119.1"><cite title="Key words for use in RFCs to Indicate Requirement Levels">[RFC2119]</cite></a>.
            </p>
         </div>
      </div>
      <hr class="noprint">
      <div>
         <h1 id="rfc.section.2" class="np"><a href="#rfc.section.2">2.</a>&nbsp;STATE AND SESSIONS
         </h1>
         <p id="rfc.section.2.p.1">This document describes a way to create stateful sessions with HTTP requests and responses. Currently, HTTP servers respond
            to each client request without relating that request to previous or subsequent requests; the state management mechanism allows
            clients and servers that wish to exchange state information to place HTTP requests and responses within a larger context,
            which we term a "session". This context might be used to create, for example, a "shopping cart", in which user selections
            can be aggregated before purchase, or a magazine browsing system, in which a user's previous reading affects which offerings
            are presented.
         </p>
         <p id="rfc.section.2.p.2">Neither clients nor servers are required to support cookies. A server <em class="bcp14">MAY</em> refuse to provide content to a client that does not return the cookies it sends.
         </p>
      </div>
      <hr class="noprint">
      <div>
         <h1 id="rfc.section.3" class="np"><a href="#rfc.section.3">3.</a>&nbsp;DESCRIPTION
         </h1>
         <p id="rfc.section.3.p.1">We describe here a way for an origin server to send state information to the user agent, and for the user agent to return
            the state information to the origin server. The goal is to have a minimal impact on HTTP and user agents.
         </p>
         <div>
            <h2 id="rfc.section.3.1"><a href="#rfc.section.3.1">3.1</a>&nbsp;Syntax: General
            </h2>
            <p id="rfc.section.3.1.p.1">The two state management headers, Set-Cookie2 and Cookie, have common syntactic properties involving attribute-value pairs.
               The following grammar uses the notation, and tokens DIGIT (decimal digits), token (informally, a sequence of non-special,
               non-white space characters), and http_URL from the HTTP/1.1 specification <a href="#RFC2616" id="rfc.xref.RFC2616.2"><cite title="Hypertext Transfer Protocol -- HTTP/1.1">[RFC2616]</cite></a> to describe their syntax.
            </p>
            <div id="rfc.figure.u.1"></div><pre class="inline">
   av-pairs    =     av-pair *(";" av-pair)
   av-pair     =     attr ["=" value]              ; optional value
   attr        =     token
   value       =     token | quoted-string
</pre><p id="rfc.section.3.1.p.3">Attributes (names) (attr) are case-insensitive. White space is permitted between tokens. Note that while the above syntax
               description shows value as optional, most attrs require them.
            </p>
            <p id="rfc.section.3.1.p.4">NOTE: The syntax above allows whitespace between the attribute and the = sign.</p>
         </div>
         <div>
            <h2 id="rfc.section.3.2"><a href="#rfc.section.3.2">3.2</a>&nbsp;Origin Server Role
            </h2>
            <div>
               <h3 id="rfc.section.3.2.1"><a href="#rfc.section.3.2.1">3.2.1</a>&nbsp;General
               </h3>
               <p id="rfc.section.3.2.1.p.1">The origin server initiates a session, if it so desires. To do so, it returns an extra response header to the client, Set-Cookie2.
                  (The details follow later.)
               </p>
               <p id="rfc.section.3.2.1.p.2">A user agent returns a Cookie request header (see below) to the origin server if it chooses to continue a session. The origin
                  server <em class="bcp14">MAY</em> ignore it or use it to determine the current state of the session. It <em class="bcp14">MAY</em> send back to the client a Set-Cookie2 response header with the same or different information, or it <em class="bcp14">MAY</em> send no Set-Cookie2 header at all. The origin server effectively ends a session by sending the client a Set-Cookie2 header
                  with Max-Age=0.
               </p>
               <p id="rfc.section.3.2.1.p.3">Servers <em class="bcp14">MAY</em> return Set-Cookie2 response headers with any response. User agents <em class="bcp14">SHOULD</em> send Cookie request headers, subject to other rules detailed below, with every request.
               </p>
               <p id="rfc.section.3.2.1.p.4">An origin server <em class="bcp14">MAY</em> include multiple Set-Cookie2 headers in a response. Note that an intervening gateway could fold multiple such headers into
                  a single header.
               </p>
            </div>
            <div>
               <div id="rfc.iref.s.1"></div>
               <div id="rfc.iref.h.1"></div>
               <h3 id="rfc.section.3.2.2"><a href="#rfc.section.3.2.2">3.2.2</a>&nbsp;Set-Cookie2 Syntax
               </h3>
               <p id="rfc.section.3.2.2.p.1">The syntax for the Set-Cookie2 response header is</p>
               <div id="rfc.figure.u.2"></div><pre class="inline">
   set-cookie      =       "Set-Cookie2:" cookies
   cookies         =       1#cookie
   cookie          =       NAME "=" VALUE *(";" set-cookie-av)
   NAME            =       attr
   VALUE           =       value
   set-cookie-av   =       "Comment" "=" value
                   |       "CommentURL" "=" &lt;"&gt; http_URL &lt;"&gt;
                   |       "Discard"
                   |       "Domain" "=" value
                   |       "Max-Age" "=" value
                   |       "Path" "=" value
                   |       "Port" [ "=" &lt;"&gt; portlist &lt;"&gt; ]
                   |       "Secure"
                   |       "Version" "=" 1*DIGIT
   portlist        =       1#portnum
   portnum         =       1*DIGIT
</pre><p id="rfc.section.3.2.2.p.3">Informally, the Set-Cookie2 response header comprises the token Set-Cookie2:, followed by a comma-separated list of one or
                  more cookies. Each cookie begins with a NAME=VALUE pair, followed by zero or more semi-colon-separated attribute-value pairs.
                  The syntax for attribute-value pairs was shown earlier. The specific attributes and the semantics of their values follows.
                  The NAME=VALUE attribute-value pair <em class="bcp14">MUST</em> come first in each cookie. The others, if present, can occur in any order. If an attribute appears more than once in a cookie,
                  the client <em class="bcp14">SHALL</em> use only the value associated with the first appearance of the attribute; a client <em class="bcp14">MUST</em> ignore values after the first.
               </p>
               <p id="rfc.section.3.2.2.p.4">The NAME of a cookie <em class="bcp14">MAY</em> be the same as one of the attributes in this specification. However, because the cookie's NAME must come first in a Set-Cookie2
                  response header, the NAME and its VALUE cannot be confused with an attribute-value pair.
               </p>
               <p id="rfc.section.3.2.2.p.5"></p>
               <dl>
                  <dt>NAME=VALUE</dt>
                  <dd>
                     <p><em class="bcp14">REQUIRED</em>. The name of the state information ("cookie") is NAME, and its value is VALUE. NAMEs that begin with $ are reserved and <em class="bcp14">MUST NOT</em> be used by applications.
                     </p>
                     <p>The VALUE is opaque to the user agent and may be anything the origin server chooses to send, possibly in a server-selected
                        printable ASCII encoding. "Opaque" implies that the content is of interest and relevance only to the origin server. The content
                        may, in fact, be readable by anyone that examines the Set-Cookie2 header.
                     </p>
                  </dd>
                  <dt>Comment=value</dt>
                  <dd>
                     <p><em class="bcp14">OPTIONAL</em>. Because cookies can be used to derive or store private information about a user, the value of the Comment attribute allows
                        an origin server to document how it intends to use the cookie. The user can inspect the information to decide whether to initiate
                        or continue a session with this cookie. Characters in value <em class="bcp14">MUST</em> be in UTF-8 encoding. <a href="#RFC2279" id="rfc.xref.RFC2279.1"><cite title="UTF-8, a transformation format of ISO 10646">[RFC2279]</cite></a> 
                     </p>
                  </dd>
                  <dt>CommentURL="http_URL"</dt>
                  <dd>
                     <p><em class="bcp14">OPTIONAL</em>. Because cookies can be used to derive or store private information about a user, the CommentURL attribute allows an origin
                        server to document how it intends to use the cookie. The user can inspect the information identified by the URL to decide
                        whether to initiate or continue a session with this cookie.
                     </p>
                  </dd>
                  <dt>Discard</dt>
                  <dd>
                     <p><em class="bcp14">OPTIONAL</em>. The Discard attribute instructs the user agent to discard the cookie unconditionally when the user agent terminates.
                     </p>
                  </dd>
                  <dt>Domain=value</dt>
                  <dd>
                     <p><em class="bcp14">OPTIONAL</em>. The value of the Domain attribute specifies the domain for which the cookie is valid. If an explicitly specified value does
                        not start with a dot, the user agent supplies a leading dot.
                     </p>
                  </dd>
                  <dt>Max-Age=value</dt>
                  <dd>
                     <p><em class="bcp14">OPTIONAL</em>. The value of the Max-Age attribute is delta-seconds, the lifetime of the cookie in seconds, a decimal non-negative integer.
                        To handle cached cookies correctly, a client <em class="bcp14">SHOULD</em> calculate the age of the cookie according to the age calculation rules in the HTTP/1.1 specification <a href="#RFC2616" id="rfc.xref.RFC2616.3"><cite title="Hypertext Transfer Protocol -- HTTP/1.1">[RFC2616]</cite></a>. When the age is greater than delta-seconds seconds, the client <em class="bcp14">SHOULD</em> discard the cookie. A value of zero means the cookie <em class="bcp14">SHOULD</em> be discarded immediately.
                     </p>
                  </dd>
                  <dt>Path=value</dt>
                  <dd>
                     <p><em class="bcp14">OPTIONAL</em>. The value of the Path attribute specifies the subset of URLs on the origin server to which this cookie applies.
                     </p>
                  </dd>
                  <dt>Port[="portlist"]</dt>
                  <dd>
                     <p><em class="bcp14">OPTIONAL</em>. The Port attribute restricts the port to which a cookie may be returned in a Cookie request header. Note that the syntax
                        REQUIREs quotes around the <em class="bcp14">OPTIONAL</em> portlist even if there is only one portnum in portlist.
                     </p>
                  </dd>
                  <dt>Secure</dt>
                  <dd>
                     <p><em class="bcp14">OPTIONAL</em>. The Secure attribute (with no value) directs the user agent to use only (unspecified) secure means to contact the origin
                        server whenever it sends back this cookie, to protect the confidentially and authenticity of the information in the cookie.
                     </p>
                     <p>The user agent (possibly with user interaction) <em class="bcp14">MAY</em> determine what level of security it considers appropriate for "secure" cookies. The Secure attribute should be considered
                        security advice from the server to the user agent, indicating that it is in the session's interest to protect the cookie contents.
                        When it sends a "secure" cookie back to a server, the user agent <em class="bcp14">SHOULD</em> use no less than the same level of security as was used when it received the cookie from the server.
                     </p>
                  </dd>
                  <dt>Version=value</dt>
                  <dd>
                     <p><em class="bcp14">REQUIRED</em>. The value of the Version attribute, a decimal integer, identifies the version of the state management specification to which
                        the cookie conforms. For this specification, Version=1 applies.
                     </p>
                  </dd>
               </dl>
            </div>
            <div>
               <h3 id="rfc.section.3.2.3"><a href="#rfc.section.3.2.3">3.2.3</a>&nbsp;Controlling Caching
               </h3>
               <p id="rfc.section.3.2.3.p.1">An origin server must be cognizant of the effect of possible caching of both the returned resource and the Set-Cookie2 header.
                  Caching "public" documents is desirable. For example, if the origin server wants to use a public document such as a "front
                  door" page as a sentinel to indicate the beginning of a session for which a Set-Cookie2 response header must be generated,
                  the page <em class="bcp14">SHOULD</em> be stored in caches "pre-expired" so that the origin server will see further requests. "Private documents", for example those
                  that contain information strictly private to a session, <em class="bcp14">SHOULD</em> NOT be cached in shared caches.
               </p>
               <p id="rfc.section.3.2.3.p.2">If the cookie is intended for use by a single user, the Set-Cookie2 header <em class="bcp14">SHOULD NOT</em> be cached. A Set-Cookie2 header that is intended to be shared by multiple users <em class="bcp14">MAY</em> be cached.
               </p>
               <p id="rfc.section.3.2.3.p.3">The origin server <em class="bcp14">SHOULD</em> send the following additional HTTP/1.1 response headers, depending on circumstances: 
               </p>
               <ul>
                  <li>To suppress caching of the Set-Cookie2 header: 
                     <div id="rfc.figure.u.3"></div><pre class="text">
    Cache-control: no-cache="set-cookie2"
</pre> </li>
               </ul>
               <p id="rfc.section.3.2.3.p.4">and one of the following: </p>
               <ul>
                  <li>To suppress caching of a private document in shared caches: 
                     <div id="rfc.figure.u.4"></div><pre class="text">
    Cache-control: private
</pre> </li>
                  <li>To allow caching of a document and require that it be validated before returning it to the client: 
                     <div id="rfc.figure.u.5"></div><pre class="text">
    Cache-Control: must-revalidate, max-age=0
</pre> </li>
                  <li>To allow caching of a document, but to require that proxy caches (not user agent caches) validate it before returning it to
                     the client: 
                     <div id="rfc.figure.u.6"></div><pre class="text">
    Cache-Control: proxy-revalidate, max-age=0
</pre> </li>
                  <li>To allow caching of a document and request that it be validated before returning it to the client (by "pre-expiring" it): 
                     <div id="rfc.figure.u.7"></div><pre class="text">
    Cache-control: max-age=0
</pre> Not all caches will revalidate the document in every case.</li>
               </ul>
               <p id="rfc.section.3.2.3.p.5">HTTP/1.1 servers <em class="bcp14">MUST</em> send Expires: old-date (where old-date is a date long in the past) on responses containing Set-Cookie2 response headers unless
                  they know for certain (by out of band means) that there are no HTTP/1.0 proxies in the response chain. HTTP/1.1 servers <em class="bcp14">MAY</em> send other Cache-Control directives that permit caching by HTTP/1.1 proxies in addition to the Expires: old-date directive;
                  the Cache-Control directive will override the Expires: old-date for HTTP/1.1 proxies.
               </p>
            </div>
         </div>
         <div>
            <h2 id="rfc.section.3.3"><a href="#rfc.section.3.3">3.3</a>&nbsp;User Agent Role
            </h2>
            <div>
               <h3 id="rfc.section.3.3.1"><a href="#rfc.section.3.3.1">3.3.1</a>&nbsp;Interpreting Set-Cookie2
               </h3>
               <p id="rfc.section.3.3.1.p.1">The user agent keeps separate track of state information that arrives via Set-Cookie2 response headers from each origin server
                  (as distinguished by name or IP address and port). The user agent <em class="bcp14">MUST</em> ignore attribute-value pairs whose attribute it does not recognize. The user agent applies these defaults for optional attributes
                  that are missing:
               </p>
               <p id="rfc.section.3.3.1.p.2"></p>
               <dl>
                  <dt>Discard</dt>
                  <dd>The default behavior is dictated by the presence or absence of a Max-Age attribute.</dd>
                  <dt>Domain</dt>
                  <dd>Defaults to the effective request-host. (Note that because there is no dot at the beginning of effective request-host, the
                     default Domain can only domain-match itself.)
                  </dd>
                  <dt>Max-Age</dt>
                  <dd>The default behavior is to discard the cookie when the user agent exits.</dd>
                  <dt>Path</dt>
                  <dd>Defaults to the path of the request URL that generated the Set-Cookie2 response, up to and including the right-most /.</dd>
                  <dt>Port</dt>
                  <dd>The default behavior is that a cookie <em class="bcp14">MAY</em> be returned to any request-port.
                  </dd>
                  <dt>Secure</dt>
                  <dd>If absent, the user agent <em class="bcp14">MAY</em> send the cookie over an insecure channel.
                  </dd>
               </dl>
            </div>
            <div>
               <h3 id="rfc.section.3.3.2"><a href="#rfc.section.3.3.2">3.3.2</a>&nbsp;Rejecting Cookies
               </h3>
               <p id="rfc.section.3.3.2.p.1">To prevent possible security or privacy violations, a user agent rejects a cookie according to rules below. The goal of the
                  rules is to try to limit the set of servers for which a cookie is valid, based on the values of the Path, Domain, and Port
                  attributes and the request-URI, request-host and request-port.
               </p>
               <p id="rfc.section.3.3.2.p.2">A user agent rejects (<em class="bcp14">SHALL NOT</em> store its information) if the Version attribute is missing. Moreover, a user agent rejects (<em class="bcp14">SHALL NOT</em> store its information) if any of the following is true of the attributes explicitly present in the Set-Cookie2 response header: 
               </p>
               <ul>
                  <li>The value for the Path attribute is not a prefix of the request-URI.</li>
                  <li>The value for the Domain attribute contains no embedded dots, and the value is not .local.</li>
                  <li>The effective host name that derives from the request-host does not domain-match the Domain attribute.</li>
                  <li>The request-host is a HDN (not IP address) and has the form HD, where D is the value of the Domain attribute, and H is a string
                     that contains one or more dots.
                  </li>
                  <li>The Port attribute has a "port-list", and the request-port was not in the list.</li>
               </ul>
               <p id="rfc.section.3.3.2.p.3">Examples: </p>
               <ul>
                  <li>A Set-Cookie2 from request-host y.x.foo.com for Domain=.foo.com would be rejected, because H is y.x and contains a dot.</li>
                  <li>A Set-Cookie2 from request-host x.foo.com for Domain=.foo.com would be accepted.</li>
                  <li>A Set-Cookie2 with Domain=.com or Domain=.com., will always be rejected, because there is no embedded dot.</li>
                  <li>A Set-Cookie2 with Domain=ajax.com will be accepted, and the value for Domain will be taken to be .ajax.com, because a dot
                     gets prepended to the value.
                  </li>
                  <li>A Set-Cookie2 with Port="80,8000" will be accepted if the request was made to port 80 or 8000 and will be rejected otherwise.</li>
                  <li>A Set-Cookie2 from request-host example for Domain=.local will be accepted, because the effective host name for the request-
                     host is example.local, and example.local domain-matches .local.
                  </li>
               </ul>
            </div>
            <div>
               <h3 id="rfc.section.3.3.3"><a href="#rfc.section.3.3.3">3.3.3</a>&nbsp;Cookie Management
               </h3>
               <p id="rfc.section.3.3.3.p.1">If a user agent receives a Set-Cookie2 response header whose NAME is the same as that of a cookie it has previously stored,
                  the new cookie supersedes the old when: the old and new Domain attribute values compare equal, using a case-insensitive string-compare;
                  and, the old and new Path attribute values string-compare equal (case-sensitive). However, if the Set-Cookie2 has a value
                  for Max-Age of zero, the (old and new) cookie is discarded. Otherwise a cookie persists (resources permitting) until whichever
                  happens first, then gets discarded: its Max-Age lifetime is exceeded; or, if the Discard attribute is set, the user agent
                  terminates the session.
               </p>
               <p id="rfc.section.3.3.3.p.2">Because user agents have finite space in which to store cookies, they <em class="bcp14">MAY</em> also discard older cookies to make space for newer ones, using, for example, a least-recently-used algorithm, along with constraints
                  on the maximum number of cookies that each origin server may set.
               </p>
               <p id="rfc.section.3.3.3.p.3">If a Set-Cookie2 response header includes a Comment attribute, the user agent <em class="bcp14">SHOULD</em> store that information in a human-readable form with the cookie and <em class="bcp14">SHOULD</em> display the comment text as part of a cookie inspection user interface.
               </p>
               <p id="rfc.section.3.3.3.p.4">If a Set-Cookie2 response header includes a CommentURL attribute, the user agent <em class="bcp14">SHOULD</em> store that information in a human-readable form with the cookie, or, preferably, <em class="bcp14">SHOULD</em> allow the user to follow the http_URL link as part of a cookie inspection user interface.
               </p>
               <p id="rfc.section.3.3.3.p.5">The cookie inspection user interface may include a facility whereby a user can decide, at the time the user agent receives
                  the Set-Cookie2 response header, whether or not to accept the cookie. A potentially confusing situation could arise if the
                  following sequence occurs: 
               </p>
               <ul>
                  <li>the user agent receives a cookie that contains a CommentURL attribute;</li>
                  <li>the user agent's cookie inspection interface is configured so that it presents a dialog to the user before the user agent
                     accepts the cookie;
                  </li>
                  <li>the dialog allows the user to follow the CommentURL link when the user agent receives the cookie; and,</li>
                  <li>when the user follows the CommentURL link, the origin server (or another server, via other links in the returned content)
                     returns another cookie.
                  </li>
               </ul>
               <p id="rfc.section.3.3.3.p.6">The user agent <em class="bcp14">SHOULD NOT</em> send any cookies in this context. The user agent <em class="bcp14">MAY</em> discard any cookie it receives in this context that the user has not, through some user agent mechanism, deemed acceptable.
               </p>
               <p id="rfc.section.3.3.3.p.7">User agents <em class="bcp14">SHOULD</em> allow the user to control cookie destruction, but they <em class="bcp14">MUST NOT</em> extend the cookie's lifetime beyond that controlled by the Discard and Max-Age attributes. An infrequently-used cookie may
                  function as a "preferences file" for network applications, and a user may wish to keep it even if it is the least-recently-used
                  cookie. One possible implementation would be an interface that allows the permanent storage of a cookie through a checkbox
                  (or, conversely, its immediate destruction).
               </p>
               <p id="rfc.section.3.3.3.p.8">Privacy considerations dictate that the user have considerable control over cookie management. The PRIVACY section contains
                  more information.
               </p>
            </div>
            <div>
               <div id="rfc.iref.c.1"></div>
               <div id="rfc.iref.h.2"></div>
               <h3 id="rfc.section.3.3.4"><a href="#rfc.section.3.3.4">3.3.4</a>&nbsp;Sending Cookies to the Origin Server
               </h3>
               <p id="rfc.section.3.3.4.p.1">When it sends a request to an origin server, the user agent includes a Cookie request header if it has stored cookies that
                  are applicable to the request, based on 
               </p>
               <ul>
                  <li>the request-host and request-port;</li>
                  <li>the request-URI;</li>
                  <li>the cookie's age.</li>
               </ul>
               <div id="rfc.figure.u.8"></div>
               <p>The syntax for the header is:</p><pre class="inline">
cookie          =  "Cookie:" cookie-version 1*((";" | ",") cookie-value)
cookie-value    =  NAME "=" VALUE [";" path] [";" domain] [";" port]
cookie-version  =  "$Version" "=" value
NAME            =  attr
VALUE           =  value
path            =  "$Path" "=" value
domain          =  "$Domain" "=" value
port            =  "$Port" [ "=" &lt;"&gt; value &lt;"&gt; ]
</pre><p id="rfc.section.3.3.4.p.3">The value of the cookie-version attribute <em class="bcp14">MUST</em> be the value from the Version attribute of the corresponding Set-Cookie2 response header. Otherwise the value for cookie-version
                  is 0. The value for the path attribute <em class="bcp14">MUST</em> be the value from the Path attribute, if one was present, of the corresponding Set-Cookie2 response header. Otherwise the
                  attribute <em class="bcp14">SHOULD</em> be omitted from the Cookie request header. The value for the domain attribute <em class="bcp14">MUST</em> be the value from the Domain attribute, if one was present, of the corresponding Set-Cookie2 response header. Otherwise the
                  attribute <em class="bcp14">SHOULD</em> be omitted from the Cookie request header.
               </p>
               <p id="rfc.section.3.3.4.p.4">The port attribute of the Cookie request header <em class="bcp14">MUST</em> mirror the Port attribute, if one was present, in the corresponding Set-Cookie2 response header. That is, the port attribute <em class="bcp14">MUST</em> be present if the Port attribute was present in the Set-Cookie2 header, and it <em class="bcp14">MUST</em> have the same value, if any. Otherwise, if the Port attribute was absent from the Set-Cookie2 header, the attribute likewise <em class="bcp14">MUST</em> be omitted from the Cookie request header.
               </p>
               <p id="rfc.section.3.3.4.p.5">Note that there is neither a Comment nor a CommentURL attribute in the Cookie request header corresponding to the ones in
                  the Set-Cookie2 response header. The user agent does not return the comment information to the origin server.
               </p>
               <p id="rfc.section.3.3.4.p.6">The user agent applies the following rules to choose applicable cookie-values to send in Cookie request headers from among
                  all the cookies it has received. 
               </p>
               <dl>
                  <dt>Domain Selection</dt>
                  <dd>The origin server's effective host name <em class="bcp14">MUST</em> domain-match the Domain attribute of the cookie.
                  </dd>
                  <dt>Port Selection</dt>
                  <dd>There are three possible behaviors, depending on the Port attribute in the Set-Cookie2 response header: 
                     <ol>
                        <li>By default (no Port attribute), the cookie <em class="bcp14">MAY</em> be sent to any port.
                        </li>
                        <li>If the attribute is present but has no value (e.g., Port), the cookie <em class="bcp14">MUST</em> only be sent to the request-port it was received from.
                        </li>
                        <li>If the attribute has a port-list, the cookie <em class="bcp14">MUST</em> only be returned if the new request-port is one of those listed in port-list.
                        </li>
                     </ol> 
                  </dd>
                  <dt>Path Selection</dt>
                  <dd>The request-URI <em class="bcp14">MUST</em> path-match the Path attribute of the cookie.
                  </dd>
                  <dt>Max-Age Selection</dt>
                  <dd>Cookies that have expired should have been discarded and thus are not forwarded to an origin server.</dd>
               </dl>
               <p id="rfc.section.3.3.4.p.7">If multiple cookies satisfy the criteria above, they are ordered in the Cookie header such that those with more specific Path
                  attributes precede those with less specific. Ordering with respect to other attributes (e.g., Domain) is unspecified.
               </p>
               <p id="rfc.section.3.3.4.p.8">Note: For backward compatibility, the separator in the Cookie header is semi-colon (;) everywhere. A server <em class="bcp14">SHOULD</em> also accept comma (,) as the separator between cookie-values for future compatibility.
               </p>
            </div>
            <div>
               <div id="rfc.iref.c.2"></div>
               <div id="rfc.iref.h.3"></div>
               <h3 id="rfc.section.3.3.5"><a href="#rfc.section.3.3.5">3.3.5</a>&nbsp;Identifying What Version is Understood:  Cookie2
               </h3>
               <p id="rfc.section.3.3.5.p.1">The Cookie2 request header facilitates interoperation between clients and servers that understand different versions of the
                  cookie specification. When the client sends one or more cookies to an origin server, if at least one of those cookies contains
                  a $Version attribute whose value is different from the version that the client understands, then the client <em class="bcp14">MUST</em> also send a Cookie2 request header, the syntax for which is
               </p>
               <div id="rfc.figure.u.9"></div><pre class="inline">
   cookie2 =       "Cookie2:" cookie-version
</pre><p id="rfc.section.3.3.5.p.3">Here the value for cookie-version is the highest version of cookie specification (currently 1) that the client understands.
                  The client needs to send at most one such request header per request.
               </p>
            </div>
            <div>
               <h3 id="rfc.section.3.3.6"><a href="#rfc.section.3.3.6">3.3.6</a>&nbsp;Sending Cookies in Unverifiable Transactions
               </h3>
               <p id="rfc.section.3.3.6.p.1">Users <em class="bcp14">MUST</em> have control over sessions in order to ensure privacy. (See PRIVACY section below.) To simplify implementation and to prevent
                  an additional layer of complexity where adequate safeguards exist, however, this document distinguishes between transactions
                  that are verifiable and those that are unverifiable. A transaction is verifiable if the user, or a user-designated agent,
                  has the option to review the request-URI prior to its use in the transaction. A transaction is unverifiable if the user does
                  not have that option. Unverifiable transactions typically arise when a user agent automatically requests inlined or embedded
                  entities or when it resolves redirection (3xx) responses from an origin server. Typically the origin transaction, the transaction
                  that the user initiates, is verifiable, and that transaction may directly or indirectly induce the user agent to make unverifiable
                  transactions.
               </p>
               <p id="rfc.section.3.3.6.p.2">An unverifiable transaction is to a third-party host if its request-host U does not domain-match the reach R of the request-host
                  O in the origin transaction.
               </p>
               <p id="rfc.section.3.3.6.p.3">When it makes an unverifiable transaction, a user agent <em class="bcp14">MUST</em> disable all cookie processing (i.e., <em class="bcp14">MUST NOT</em> send cookies, and <em class="bcp14">MUST NOT</em> accept any received cookies) if the transaction is to a third-party host.
               </p>
               <p id="rfc.section.3.3.6.p.4">This restriction prevents a malicious service author from using unverifiable transactions to induce a user agent to start
                  or continue a session with a server in a different domain. The starting or continuation of such sessions could be contrary
                  to the privacy expectations of the user, and could also be a security problem.
               </p>
               <p id="rfc.section.3.3.6.p.5">User agents <em class="bcp14">MAY</em> offer configurable options that allow the user agent, or any autonomous programs that the user agent executes, to ignore the
                  above rule, so long as these override options default to "off".
               </p>
               <p id="rfc.section.3.3.6.p.6">(N.B. Mechanisms may be proposed that will automate overriding the third-party restrictions under controlled conditions.)</p>
               <p id="rfc.section.3.3.6.p.7">Many current user agents already provide a review option that would render many links verifiable. For instance, some user
                  agents display the URL that would be referenced for a particular link when the mouse pointer is placed over that link. The
                  user can therefore determine whether to visit that site before causing the browser to do so. (Though not implemented on current
                  user agents, a similar technique could be used for a button used to submit a form -- the user agent could display the action
                  to be taken if the user were to select that button.) However, even this would not make all links verifiable; for example,
                  links to automatically loaded images would not normally be subject to "mouse pointer" verification.
               </p>
               <p id="rfc.section.3.3.6.p.8">Many user agents also provide the option for a user to view the HTML source of a document, or to save the source to an external
                  file where it can be viewed by another application. While such an option does provide a crude review mechanism, some users
                  might not consider it acceptable for this purpose.
               </p>
            </div>
         </div>
         <div>
            <h2 id="rfc.section.3.4"><a href="#rfc.section.3.4">3.4</a>&nbsp;How an Origin Server Interprets the Cookie Header
            </h2>
            <p id="rfc.section.3.4.p.1">A user agent returns much of the information in the Set-Cookie2 header to the origin server when the request-URI path-matches
               the Path attribute of the cookie. When it receives a Cookie header, the origin server <em class="bcp14">SHOULD</em> treat cookies with NAMEs whose prefix is $ specially, as an attribute for the cookie.
            </p>
         </div>
         <div>
            <h2 id="rfc.section.3.5"><a href="#rfc.section.3.5">3.5</a>&nbsp;Caching Proxy Role
            </h2>
            <p id="rfc.section.3.5.p.1">One reason for separating state information from both a URL and document content is to facilitate the scaling that caching
               permits. To support cookies, a caching proxy <em class="bcp14">MUST</em> obey these rules already in the HTTP specification: 
            </p>
            <ul>
               <li>Honor requests from the cache, if possible, based on cache validity rules.</li>
               <li>Pass along a Cookie request header in any request that the proxy must make of another server.</li>
               <li>Return the response to the client. Include any Set-Cookie2 response header.</li>
               <li>Cache the received response subject to the control of the usual headers, such as Expires, 
                  <div id="rfc.figure.u.10"></div><pre class="text">
   Cache-control: no-cache
</pre> and <div id="rfc.figure.u.11"></div><pre class="text">
   Cache-control: private
</pre> </li>
               <li>Cache the Set-Cookie2 subject to the control of the usual header, 
                  <div id="rfc.figure.u.12"></div><pre class="text">
   Cache-control: no-cache="set-cookie2"
</pre> (The Set-Cookie2 header should usually not be cached.)</li>
            </ul>
            <p id="rfc.section.3.5.p.2">Proxies <em class="bcp14">MUST NOT</em> introduce Set-Cookie2 (Cookie) headers of their own in proxy responses (requests).
            </p>
         </div>
      </div>
      <hr class="noprint">
      <div>
         <h1 id="rfc.section.4" class="np"><a href="#rfc.section.4">4.</a>&nbsp;EXAMPLES
         </h1>
         <div>
            <h2 id="rfc.section.4.1"><a href="#rfc.section.4.1">4.1</a>&nbsp;Example 1
            </h2>
            <p id="rfc.section.4.1.p.1">Most detail of request and response headers has been omitted. Assume the user agent has no stored cookies.</p>
            <p id="rfc.section.4.1.p.2">1. User Agent -&gt; Server</p>
            <div id="rfc.figure.u.13"></div><pre class="text2">
    POST /acme/login HTTP/1.1
    [form data]
</pre><p id="rfc.section.4.1.p.4">User identifies self via a form.</p>
            <p id="rfc.section.4.1.p.5">2. Server -&gt; User Agent</p>
            <div id="rfc.figure.u.14"></div><pre class="text">
    HTTP/1.1 200 OK
    Set-Cookie2: Customer="WILE_E_COYOTE"; Version="1"; Path="/acme"
</pre><p id="rfc.section.4.1.p.7">Cookie reflects user's identity.</p>
            <p id="rfc.section.4.1.p.8">3. User Agent -&gt; Server</p>
            <div id="rfc.figure.u.15"></div><pre class="text2">
    POST /acme/pickitem HTTP/1.1
    Cookie: $Version="1"; Customer="WILE_E_COYOTE"; $Path="/acme"
    [form data]
</pre><p id="rfc.section.4.1.p.10">User selects an item for "shopping basket".</p>
            <p id="rfc.section.4.1.p.11">4. Server -&gt; User Agent</p>
            <div id="rfc.figure.u.16"></div><pre class="text">
    HTTP/1.1 200 OK
    Set-Cookie2: Part_Number="Rocket_Launcher_0001"; Version="1";
            Path="/acme"
</pre><p id="rfc.section.4.1.p.13">Shopping basket contains an item.</p>
            <p id="rfc.section.4.1.p.14">5. User Agent -&gt; Server</p>
            <div id="rfc.figure.u.17"></div><pre class="text2">
    POST /acme/shipping HTTP/1.1
    Cookie: $Version="1";
            Customer="WILE_E_COYOTE"; $Path="/acme";
            Part_Number="Rocket_Launcher_0001"; $Path="/acme"
    [form data]
</pre><p id="rfc.section.4.1.p.16">User selects shipping method from form.</p>
            <p id="rfc.section.4.1.p.17">6. Server -&gt; User Agent</p>
            <div id="rfc.figure.u.18"></div><pre class="text">
    HTTP/1.1 200 OK
    Set-Cookie2: Shipping="FedEx"; Version="1"; Path="/acme"
</pre><p id="rfc.section.4.1.p.19">New cookie reflects shipping method.</p>
            <p id="rfc.section.4.1.p.20">7. User Agent -&gt; Server</p>
            <div id="rfc.figure.u.19"></div><pre class="text2">
    POST /acme/process HTTP/1.1
    Cookie: $Version="1";
            Customer="WILE_E_COYOTE"; $Path="/acme";
            Part_Number="Rocket_Launcher_0001"; $Path="/acme";
            Shipping="FedEx"; $Path="/acme"
    [form data]
</pre><p id="rfc.section.4.1.p.22">User chooses to process order.</p>
            <p id="rfc.section.4.1.p.23">8. Server -&gt; User Agent</p>
            <div id="rfc.figure.u.20"></div><pre class="text">
    HTTP/1.1 200 OK
</pre><p id="rfc.section.4.1.p.25">Transaction is complete.</p>
            <p id="rfc.section.4.1.p.26">The user agent makes a series of requests on the origin server, after each of which it receives a new cookie. All the cookies
               have the same Path attribute and (default) domain. Because the request-URIs all path-match /acme, the Path attribute of each
               cookie, each request contains all the cookies received so far.
            </p>
         </div>
         <div>
            <h2 id="rfc.section.4.2"><a href="#rfc.section.4.2">4.2</a>&nbsp;Example 2
            </h2>
            <p id="rfc.section.4.2.p.1">This example illustrates the effect of the Path attribute. All detail of request and response headers has been omitted. Assume
               the user agent has no stored cookies.
            </p>
            <p id="rfc.section.4.2.p.2">Imagine the user agent has received, in response to earlier requests, the response headers</p>
            <div id="rfc.figure.u.21"></div><pre class="text">
   Set-Cookie2: Part_Number="Rocket_Launcher_0001"; Version="1";
           Path="/acme"
</pre><p id="rfc.section.4.2.p.4">and</p>
            <div id="rfc.figure.u.22"></div><pre class="text">
   Set-Cookie2: Part_Number="Riding_Rocket_0023"; Version="1";
           Path="/acme/ammo"
</pre><p id="rfc.section.4.2.p.6">A subsequent request by the user agent to the (same) server for URLs of the form /acme/ammo/... would include the following
               request header:
            </p>
            <div id="rfc.figure.u.23"></div><pre class="text">
   Cookie: $Version="1";
           Part_Number="Riding_Rocket_0023"; $Path="/acme/ammo";
           Part_Number="Rocket_Launcher_0001"; $Path="/acme"
</pre><p id="rfc.section.4.2.p.8">Note that the NAME=VALUE pair for the cookie with the more specific Path attribute, /acme/ammo, comes before the one with
               the less specific Path attribute, /acme. Further note that the same cookie name appears more than once.
            </p>
            <p id="rfc.section.4.2.p.9">A subsequent request by the user agent to the (same) server for a URL of the form /acme/parts/ would include the following
               request header:
            </p>
            <div id="rfc.figure.u.24"></div><pre class="text">
   Cookie: $Version="1"; Part_Number="Rocket_Launcher_0001";
   $Path="/acme"
</pre><p id="rfc.section.4.2.p.11">Here, the second cookie's Path attribute /acme/ammo is not a prefix of the request URL, /acme/parts/, so the cookie does not
               get forwarded to the server.
            </p>
         </div>
      </div>
      <hr class="noprint">
      <div>
         <h1 id="rfc.section.5" class="np"><a href="#rfc.section.5">5.</a>&nbsp;IMPLEMENTATION CONSIDERATIONS
         </h1>
         <p id="rfc.section.5.p.1">Here we provide guidance on likely or desirable details for an origin server that implements state management.</p>
         <div>
            <h2 id="rfc.section.5.1"><a href="#rfc.section.5.1">5.1</a>&nbsp;Set-Cookie2 Content
            </h2>
            <p id="rfc.section.5.1.p.1">An origin server's content should probably be divided into disjoint application areas, some of which require the use of state
               information. The application areas can be distinguished by their request URLs. The Set-Cookie2 header can incorporate information
               about the application areas by setting the Path attribute for each one.
            </p>
            <p id="rfc.section.5.1.p.2">The session information can obviously be clear or encoded text that describes state. However, if it grows too large, it can
               become unwieldy. Therefore, an implementor might choose for the session information to be a key to a server-side resource.
               Of course, using a database creates some problems that this state management specification was meant to avoid, namely: 
            </p>
            <ol>
               <li>keeping real state on the server side;</li>
               <li>how and when to garbage-collect the database entry, in case the user agent terminates the session by, for example, exiting.</li>
            </ol>
         </div>
         <div>
            <h2 id="rfc.section.5.2"><a href="#rfc.section.5.2">5.2</a>&nbsp;Stateless Pages
            </h2>
            <p id="rfc.section.5.2.p.1">Caching benefits the scalability of WWW. Therefore it is important to reduce the number of documents that have state embedded
               in them inherently. For example, if a shopping-basket-style application always displays a user's current basket contents on
               each page, those pages cannot be cached, because each user's basket's contents would be different. On the other hand, if each
               page contains just a link that allows the user to "Look at My Shopping Basket", the page can be cached.
            </p>
         </div>
         <div>
            <h2 id="rfc.section.5.3"><a href="#rfc.section.5.3">5.3</a>&nbsp;Implementation Limits
            </h2>
            <p id="rfc.section.5.3.p.1">Practical user agent implementations have limits on the number and size of cookies that they can store. In general, user agents'
               cookie support should have no fixed limits. They should strive to store as many frequently-used cookies as possible. Furthermore,
               general-use user agents <em class="bcp14">SHOULD</em> provide each of the following minimum capabilities individually, although not necessarily simultaneously: 
            </p>
            <ul>
               <li>at least 300 cookies</li>
               <li>at least 4096 bytes per cookie (as measured by the characters that comprise the cookie non-terminal in the syntax description
                  of the Set-Cookie2 header, and as received in the Set-Cookie2 header)
               </li>
               <li>at least 20 cookies per unique host or domain name</li>
            </ul>
            <p id="rfc.section.5.3.p.2">User agents created for specific purposes or for limited-capacity devices <em class="bcp14">SHOULD</em> provide at least 20 cookies of 4096 bytes, to ensure that the user can interact with a session-based origin server.
            </p>
            <p id="rfc.section.5.3.p.3">The information in a Set-Cookie2 response header <em class="bcp14">MUST</em> be retained in its entirety. If for some reason there is inadequate space to store the cookie, it <em class="bcp14">MUST</em> be discarded, not truncated.
            </p>
            <p id="rfc.section.5.3.p.4">Applications should use as few and as small cookies as possible, and they should cope gracefully with the loss of a cookie.</p>
            <div>
               <h3 id="rfc.section.5.3.1"><a href="#rfc.section.5.3.1">5.3.1</a>&nbsp;Denial of Service Attacks
               </h3>
               <p id="rfc.section.5.3.1.p.1">User agents <em class="bcp14">MAY</em> choose to set an upper bound on the number of cookies to be stored from a given host or domain name or on the size of the
                  cookie information. Otherwise a malicious server could attempt to flood a user agent with many cookies, or large cookies,
                  on successive responses, which would force out cookies the user agent had received from other servers. However, the minima
                  specified above <em class="bcp14">SHOULD</em> still be supported.
               </p>
            </div>
         </div>
      </div>
      <hr class="noprint">
      <div>
         <h1 id="rfc.section.6" class="np"><a href="#rfc.section.6">6.</a>&nbsp;PRIVACY
         </h1>
         <p id="rfc.section.6.p.1">Informed consent should guide the design of systems that use cookies. A user should be able to find out how a web site plans
            to use information in a cookie and should be able to choose whether or not those policies are acceptable. Both the user agent
            and the origin server must assist informed consent.
         </p>
         <div>
            <h2 id="rfc.section.6.1"><a href="#rfc.section.6.1">6.1</a>&nbsp;User Agent Control
            </h2>
            <p id="rfc.section.6.1.p.1">An origin server could create a Set-Cookie2 header to track the path of a user through the server. Users may object to this
               behavior as an intrusive accumulation of information, even if their identity is not evident. (Identity might become evident,
               for example, if a user subsequently fills out a form that contains identifying information.) This state management specification
               therefore requires that a user agent give the user control over such a possible intrusion, although the interface through
               which the user is given this control is left unspecified. However, the control mechanisms provided <em class="bcp14">SHALL</em> at least allow the user 
            </p>
            <ul>
               <li>to completely disable the sending and saving of cookies.</li>
               <li>to determine whether a stateful session is in progress.</li>
               <li>to control the saving of a cookie on the basis of the cookie's Domain attribute.</li>
            </ul>
            <p id="rfc.section.6.1.p.2">Such control could be provided, for example, by mechanisms </p>
            <ul>
               <li>to notify the user when the user agent is about to send a cookie to the origin server, to offer the option not to begin a
                  session.
               </li>
               <li>to display a visual indication that a stateful session is in progress.</li>
               <li>to let the user decide which cookies, if any, should be saved when the user concludes a window or user agent session.</li>
               <li>to let the user examine and delete the contents of a cookie at any time.</li>
            </ul>
            <p id="rfc.section.6.1.p.3">A user agent usually begins execution with no remembered state information. It <em class="bcp14">SHOULD</em> be possible to configure a user agent never to send Cookie headers, in which case it can never sustain state with an origin
               server. (The user agent would then behave like one that is unaware of how to handle Set-Cookie2 response headers.)
            </p>
            <p id="rfc.section.6.1.p.4">When the user agent terminates execution, it <em class="bcp14">SHOULD</em> let the user discard all state information. Alternatively, the user agent <em class="bcp14">MAY</em> ask the user whether state information should be retained; the default should be "no". If the user chooses to retain state
               information, it would be restored the next time the user agent runs.
            </p>
            <p id="rfc.section.6.1.p.5">NOTE: User agents should probably be cautious about using files to store cookies long-term. If a user runs more than one instance
               of the user agent, the cookies could be commingled or otherwise corrupted.
            </p>
         </div>
         <div>
            <h2 id="rfc.section.6.2"><a href="#rfc.section.6.2">6.2</a>&nbsp;Origin Server Role
            </h2>
            <p id="rfc.section.6.2.p.1">An origin server <em class="bcp14">SHOULD</em> promote informed consent by adding CommentURL or Comment information to the cookies it sends. CommentURL is preferred because
               of the opportunity to provide richer information in a multiplicity of languages.
            </p>
         </div>
         <div>
            <h2 id="rfc.section.6.3"><a href="#rfc.section.6.3">6.3</a>&nbsp;Clear Text
            </h2>
            <p id="rfc.section.6.3.p.1">The information in the Set-Cookie2 and Cookie headers is unprotected. As a consequence: </p>
            <ol>
               <li>Any sensitive information that is conveyed in them is exposed to intruders.</li>
               <li>A malicious intermediary could alter the headers as they travel in either direction, with unpredictable results.</li>
            </ol>
            <p id="rfc.section.6.3.p.2">These facts imply that information of a personal and/or financial nature should only be sent over a secure channel. For less
               sensitive information, or when the content of the header is a database key, an origin server should be vigilant to prevent
               a bad Cookie value from causing failures.
            </p>
            <p id="rfc.section.6.3.p.3">A user agent in a shared user environment poses a further risk. Using a cookie inspection interface, User B could examine
               the contents of cookies that were saved when User A used the machine.
            </p>
         </div>
      </div>
      <hr class="noprint">
      <div>
         <h1 id="rfc.section.7" class="np"><a href="#rfc.section.7">7.</a>&nbsp;SECURITY CONSIDERATIONS
         </h1>
         <div>
            <h2 id="rfc.section.7.1"><a href="#rfc.section.7.1">7.1</a>&nbsp;Protocol Design
            </h2>
            <p id="rfc.section.7.1.p.1">The restrictions on the value of the Domain attribute, and the rules concerning unverifiable transactions, are meant to reduce
               the ways that cookies can "leak" to the "wrong" site. The intent is to restrict cookies to one host, or a closely related
               set of hosts. Therefore a request-host is limited as to what values it can set for Domain. We consider it acceptable for hosts
               host1.foo.com and host2.foo.com to share cookies, but not a.com and b.com.
            </p>
            <p id="rfc.section.7.1.p.2">Similarly, a server can set a Path only for cookies that are related to the request-URI.</p>
         </div>
         <div>
            <h2 id="rfc.section.7.2"><a href="#rfc.section.7.2">7.2</a>&nbsp;Cookie Spoofing
            </h2>
            <p id="rfc.section.7.2.p.1">Proper application design can avoid spoofing attacks from related domains. Consider: </p>
            <ol>
               <li>User agent makes request to victim.cracker.edu, gets back cookie session_id="1234" and sets the default domain victim.cracker.edu.</li>
               <li>User agent makes request to spoof.cracker.edu, gets back cookie session-id="1111", with Domain=".cracker.edu".</li>
               <li>User agent makes request to victim.cracker.edu again, and passes 
                  <div id="rfc.figure.u.25"></div><pre class="text">
     Cookie: $Version="1"; session_id="1234",
             $Version="1"; session_id="1111"; $Domain=".cracker.edu"
</pre> The server at victim.cracker.edu should detect that the second cookie was not one it originated by noticing that the Domain
                  attribute is not for itself and ignore it.</li>
            </ol>
         </div>
         <div>
            <h2 id="rfc.section.7.3"><a href="#rfc.section.7.3">7.3</a>&nbsp;Unexpected Cookie Sharing
            </h2>
            <p id="rfc.section.7.3.p.1">A user agent <em class="bcp14">SHOULD</em> make every attempt to prevent the sharing of session information between hosts that are in different domains. Embedded or
               inlined objects may cause particularly severe privacy problems if they can be used to share cookies between disparate hosts.
               For example, a malicious server could embed cookie information for host a.com in a URI for a CGI on host b.com. User agent
               implementors are strongly encouraged to prevent this sort of exchange whenever possible.
            </p>
         </div>
         <div>
            <h2 id="rfc.section.7.4"><a href="#rfc.section.7.4">7.4</a>&nbsp;Cookies For Account Information
            </h2>
            <p id="rfc.section.7.4.p.1">While it is common practice to use them this way, cookies are not designed or intended to be used to hold authentication information,
               such as account names and passwords. Unless such cookies are exchanged over an encrypted path, the account information they
               contain is highly vulnerable to perusal and theft.
            </p>
         </div>
      </div>
      <hr class="noprint">
      <div>
         <h1 id="rfc.section.8" class="np"><a href="#rfc.section.8">8.</a>&nbsp;OTHER, SIMILAR, PROPOSALS
         </h1>
         <p id="rfc.section.8.p.1">Apart from RFC 2109, three other proposals have been made to accomplish similar goals. This specification began as an amalgam
            of Kristol's State-Info proposal <a href="#DMK95" id="rfc.xref.DMK95.1"><cite title="Proposed HTTP State-Info Mechanism">[DMK95]</cite></a> and Netscape's Cookie proposal <a href="#Netscape" id="rfc.xref.Netscape.2"><cite title="Persistent Client State -- HTTP Cookies">[Netscape]</cite></a>.
         </p>
         <p id="rfc.section.8.p.2">Brian Behlendorf proposed a Session-ID header that would be user-agent-initiated and could be used by an origin server to
            track "clicktrails". It would not carry any origin-server-defined state, however. Phillip Hallam-Baker has proposed another
            client-defined session ID mechanism for similar purposes.
         </p>
         <p id="rfc.section.8.p.3">While both session IDs and cookies can provide a way to sustain stateful sessions, their intended purpose is different, and,
            consequently, the privacy requirements for them are different. A user initiates session IDs to allow servers to track progress
            through them, or to distinguish multiple users on a shared machine. Cookies are server-initiated, so the cookie mechanism
            described here gives users control over something that would otherwise take place without the users' awareness. Furthermore,
            cookies convey rich, server-selected information, whereas session IDs comprise user-selected, simple information.
         </p>
      </div>
      <hr class="noprint">
      <div>
         <h1 id="rfc.section.9" class="np"><a href="#rfc.section.9">9.</a>&nbsp;HISTORICAL
         </h1>
         <div>
            <h2 id="rfc.section.9.1"><a href="#rfc.section.9.1">9.1</a>&nbsp;Compatibility with Existing Implementations
            </h2>
            <p id="rfc.section.9.1.p.1">Existing cookie implementations, based on the Netscape specification, use the Set-Cookie (not Set-Cookie2) header. User agents
               that receive in the same response both a Set-Cookie and Set-Cookie2 response header for the same cookie <em class="bcp14">MUST</em> discard the Set-Cookie information and use only the Set-Cookie2 information. Furthermore, a user agent <em class="bcp14">MUST</em> assume, if it received a Set-Cookie2 response header, that the sending server complies with this document and will understand
               Cookie request headers that also follow this specification.
            </p>
            <p id="rfc.section.9.1.p.2">New cookies <em class="bcp14">MUST</em> replace both equivalent old- and new-style cookies. That is, if a user agent that follows both this specification and Netscape's
               original specification receives a Set-Cookie2 response header, and the NAME and the Domain and Path attributes match (per
               the Cookie Management section) a Netscape-style cookie, the Netscape-style cookie <em class="bcp14">MUST</em> be discarded, and the user agent <em class="bcp14">MUST</em> retain only the cookie adhering to this specification.
            </p>
            <p id="rfc.section.9.1.p.3">Older user agents that do not understand this specification, but that do understand Netscape's original specification, will
               not recognize the Set-Cookie2 response header and will receive and send cookies according to the older specification.
            </p>
            <p id="rfc.section.9.1.p.4">A user agent that supports both this specification and Netscape-style cookies <em class="bcp14">SHOULD</em> send a Cookie request header that follows the older Netscape specification if it received the cookie in a Set-Cookie response
               header and not in a Set-Cookie2 response header. However, it <em class="bcp14">SHOULD</em> send the following request header as well:
            </p>
            <div id="rfc.figure.u.26"></div><pre class="text">
   Cookie2: $Version="1"
</pre><p id="rfc.section.9.1.p.6">The Cookie2 header advises the server that the user agent understands new-style cookies. If the server understands new-style
               cookies, as well, it <em class="bcp14">SHOULD</em> continue the stateful session by sending a Set-Cookie2 response header, rather than Set-Cookie. A server that does not understand
               new-style cookies will simply ignore the Cookie2 request header.
            </p>
         </div>
         <div>
            <h2 id="rfc.section.9.2"><a href="#rfc.section.9.2">9.2</a>&nbsp;Caching and HTTP/1.0
            </h2>
            <p id="rfc.section.9.2.p.1">Some caches, such as those conforming to HTTP/1.0, will inevitably cache the Set-Cookie2 and Set-Cookie headers, because there
               was no mechanism to suppress caching of headers prior to HTTP/1.1. This caching can lead to security problems. Documents transmitted
               by an origin server along with Set-Cookie2 and Set-Cookie headers usually either will be uncachable, or will be "pre-expired".
               As long as caches obey instructions not to cache documents (following Expires: &lt;a date in the past&gt; or Pragma: no-cache (HTTP/1.0),
               or Cache-control: no-cache (HTTP/1.1)) uncachable documents present no problem. However, pre-expired documents may be stored
               in caches. They require validation (a conditional GET) on each new request, but some cache operators loosen the rules for
               their caches, and sometimes serve expired documents without first validating them. This combination of factors can lead to
               cookies meant for one user later being sent to another user. The Set-Cookie2 and Set-Cookie headers are stored in the cache,
               and, although the document is stale (expired), the cache returns the document in response to later requests, including cached
               headers.
            </p>
         </div>
      </div>
      <hr class="noprint">
      <div>
         <h1 id="rfc.section.10" class="np"><a href="#rfc.section.10">10.</a>&nbsp;ACKNOWLEDGEMENTS
         </h1>
         <p id="rfc.section.10.p.1">This document really represents the collective efforts of the HTTP Working Group of the IETF and, particularly, the following
            people, in addition to the authors: Roy Fielding, Yaron Goland, Marc Hedlund, Ted Hardie, Koen Holtman, Shel Kaphan, Rohit
            Khare, Foteos Macrides, David W. Morris.
         </p>
      </div>
      <h1 class="np" id="rfc.references"><a href="#rfc.section.11" id="rfc.section.11">11.</a> References
      </h1>
      <table>
         <tr>
            <td class="reference"><b id="DMK95">[DMK95]</b></td>
            <td class="top">Kristol, D., “<a href="http://portal.research.bell-labs.com/~dmk/state-info.html">Proposed HTTP State-Info Mechanism</a>”, September&nbsp;1995, &lt;<a href="http://portal.research.bell-labs.com/~dmk/state-info.html">http://portal.research.bell-labs.com/~dmk/state-info.html</a>&gt;.<br>available at &lt;http://portal.research.bell-labs.com/~dmk/state-info.html&gt;
            </td>
         </tr>
         <tr>
            <td class="reference"><b id="Netscape">[Netscape]</b></td>
            <td class="top">“<a href="http://www.netscape.com/newsref/std/cookie_spec.html">Persistent Client State -- HTTP Cookies</a>”, &lt;<a href="http://www.netscape.com/newsref/std/cookie_spec.html">http://www.netscape.com/newsref/std/cookie_spec.html</a>&gt;.<br>available at &lt;http://www.netscape.com/newsref/std/cookie_spec.html&gt;
            </td>
         </tr>
         <tr>
            <td class="reference"><b id="RFC2109">[RFC2109]</b></td>
            <td class="top"><a href="mailto:dmk@bell-labs.com" title="Bell Laboratories, Lucent Technologies">Kristol, D.</a> and <a href="mailto:montulli@netscape.com" title="Netscape Communications Corp.">L. Montulli</a>, “<a href="http://tools.ietf.org/html/rfc2109">HTTP State Management Mechanism</a>”, RFC&nbsp;2109, February&nbsp;1997.
            </td>
         </tr>
         <tr>
            <td class="reference"><b id="RFC2119">[RFC2119]</b></td>
            <td class="top"><a href="mailto:sob@harvard.edu" title="Harvard University">Bradner, S.</a>, “<a href="http://tools.ietf.org/html/rfc2119">Key words for use in RFCs to Indicate Requirement Levels</a>”, BCP&nbsp;14, RFC&nbsp;2119, March&nbsp;1997.
            </td>
         </tr>
         <tr>
            <td class="reference"><b id="RFC2279">[RFC2279]</b></td>
            <td class="top"><a href="mailto:fyergeau@alis.com" title="Alis Technologies">Yergeau, F.</a>, “<a href="http://tools.ietf.org/html/rfc2279">UTF-8, a transformation format of ISO 10646</a>”, RFC&nbsp;2279, January&nbsp;1998.
            </td>
         </tr>
         <tr>
            <td class="reference"><b id="RFC2396">[RFC2396]</b></td>
            <td class="top"><a href="mailto:timbl@w3.org" title="World Wide Web Consortium">Berners-Lee, T.</a>, <a href="mailto:fielding@ics.uci.edu" title="Department of Information and Computer Science">Fielding, R.</a>, and <a href="mailto:masinter@parc.xerox.com" title="Xerox PARC">L. Masinter</a>, “<a href="http://tools.ietf.org/html/rfc2396">Uniform Resource Identifiers (URI): Generic Syntax</a>”, RFC&nbsp;2396, August&nbsp;1998.
            </td>
         </tr>
         <tr>
            <td class="reference"><b id="RFC2616">[RFC2616]</b></td>
            <td class="top"><a href="mailto:fielding@ics.uci.edu" title="University of California, Irvine">Fielding, R.</a>, <a href="mailto:jg@w3.org" title="W3C">Gettys, J.</a>, <a href="mailto:mogul@wrl.dec.com" title="Compaq Computer Corporation">Mogul, J.</a>, <a href="mailto:frystyk@w3.org" title="MIT Laboratory for Computer Science">Frystyk, H.</a>, <a href="mailto:masinter@parc.xerox.com" title="Xerox Corporation">Masinter, L.</a>, <a href="mailto:paulle@microsoft.com" title="Microsoft Corporation">Leach, P.</a>, and <a href="mailto:timbl@w3.org" title="W3C">T. Berners-Lee</a>, “<a href="http://tools.ietf.org/html/rfc2616">Hypertext Transfer Protocol -- HTTP/1.1</a>”, RFC&nbsp;2616, June&nbsp;1999.
            </td>
         </tr>
      </table>
      <hr class="noprint">
      <div class="avoidbreak">
         <h1 id="rfc.authors" class="np"><a href="#rfc.authors">Authors' Addresses</a></h1>
         <p><b>David M. Kristol</b><br>Bell Laboratories, Lucent Technologies<br>600 Mountain Ave. Room 2A-333<br>Murray Hill, NJ&nbsp;07974<br>Phone: <a href="tel:(908)582-2250">(908) 582-2250</a><br>Fax: <a href="fax:(908)582-1239">(908) 582-1239</a><br>EMail: <a href="mailto:dmk@bell-labs.com">dmk@bell-labs.com</a></p>
         <p><b>Lou Montulli</b><br>Epinions.com, Inc.<br>2037 Landings Dr.<br>Mountain View, CA&nbsp;94301<br>EMail: <a href="mailto:lou@montulli.org">lou@montulli.org</a></p>
      </div>
      <hr class="noprint">
      <h1 id="rfc.index" class="np"><a href="#rfc.index">Index</a></h1>
      <p class="noprint"><a href="#rfc.index.C">C</a> <a href="#rfc.index.D">D</a> <a href="#rfc.index.H">H</a> <a href="#rfc.index.N">N</a> <a href="#rfc.index.R">R</a> <a href="#rfc.index.S">S</a> 
      </p>
      <div class="print2col">
         <ul class="ind">
            <li><a id="rfc.index.C" href="#rfc.index.C"><b>C</b></a><ul>
                  <li>Cookie header&nbsp;&nbsp;<a href="#rfc.iref.c.1"><b>3.3.4</b></a></li>
                  <li>Cookie2 header&nbsp;&nbsp;<a href="#rfc.iref.c.2"><b>3.3.5</b></a></li>
               </ul>
            </li>
            <li><a id="rfc.index.D" href="#rfc.index.D"><b>D</b></a><ul>
                  <li><em>DMK95</em>&nbsp;&nbsp;<a href="#rfc.xref.DMK95.1">8</a>, <a href="#DMK95"><b>11</b></a></li>
               </ul>
            </li>
            <li><a id="rfc.index.H" href="#rfc.index.H"><b>H</b></a><ul>
                  <li>Headers&nbsp;&nbsp;
                     <ul>
                        <li>Cookie&nbsp;&nbsp;<a href="#rfc.iref.h.2"><b>3.3.4</b></a></li>
                        <li>Cookie2&nbsp;&nbsp;<a href="#rfc.iref.h.3"><b>3.3.5</b></a></li>
                        <li>Set-Cookie2&nbsp;&nbsp;<a href="#rfc.iref.h.1"><b>3.2.2</b></a></li>
                     </ul>
                  </li>
               </ul>
            </li>
            <li><a id="rfc.index.N" href="#rfc.index.N"><b>N</b></a><ul>
                  <li><em>Netscape</em>&nbsp;&nbsp;<a href="#rfc.xref.Netscape.1">§</a>, <a href="#rfc.xref.Netscape.2">8</a>, <a href="#Netscape"><b>11</b></a></li>
               </ul>
            </li>
            <li><a id="rfc.index.R" href="#rfc.index.R"><b>R</b></a><ul>
                  <li><em>RFC2109</em>&nbsp;&nbsp;<a href="#RFC2109"><b>11</b></a></li>
                  <li><em>RFC2119</em>&nbsp;&nbsp;<a href="#rfc.xref.RFC2119.1">1.1</a>, <a href="#RFC2119"><b>11</b></a></li>
                  <li><em>RFC2279</em>&nbsp;&nbsp;<a href="#rfc.xref.RFC2279.1">3.2.2</a>, <a href="#RFC2279"><b>11</b></a></li>
                  <li><em>RFC2396</em>&nbsp;&nbsp;<a href="#rfc.xref.RFC2396.1">1</a>, <a href="#RFC2396"><b>11</b></a></li>
                  <li><em>RFC2616</em>&nbsp;&nbsp;<a href="#rfc.xref.RFC2616.1">1</a>, <a href="#rfc.xref.RFC2616.2">3.1</a>, <a href="#rfc.xref.RFC2616.3">3.2.2</a>, <a href="#RFC2616"><b>11</b></a></li>
               </ul>
            </li>
            <li><a id="rfc.index.S" href="#rfc.index.S"><b>S</b></a><ul>
                  <li>Set-Cookie2 header&nbsp;&nbsp;<a href="#rfc.iref.s.1"><b>3.2.2</b></a></li>
               </ul>
            </li>
         </ul>
      </div>
      <div id="rfc.copyright">
         <h1><a href="#rfc.copyright">Full Copyright Statement</a></h1>
         <p>Copyright © The Internet Society (2000). All Rights Reserved.</p>
         <p>This document and translations of it may be copied and furnished to others, and derivative works that comment on or otherwise
            explain it or assist in its implementation may be prepared, copied, published and distributed, in whole or in part, without
            restriction of any kind, provided that the above copyright notice and this paragraph are included on all such copies and derivative
            works. However, this document itself may not be modified in any way, such as by removing the copyright notice or references
            to the Internet Society or other Internet organizations, except as needed for the purpose of developing Internet standards
            in which case the procedures for copyrights defined in the Internet Standards process must be followed, or as required to
            translate it into languages other than English.
         </p>
         <p>The limited permissions granted above are perpetual and will not be revoked by the Internet Society or its successors or assigns.</p>
         <p>This document and the information contained herein is provided on an “AS IS” basis and THE INTERNET SOCIETY AND THE INTERNET
            ENGINEERING TASK FORCE DISCLAIMS ALL WARRANTIES, EXPRESS OR IMPLIED, INCLUDING BUT NOT LIMITED TO ANY WARRANTY THAT THE USE
            OF THE INFORMATION HEREIN WILL NOT INFRINGE ANY RIGHTS OR ANY IMPLIED WARRANTIES OF MERCHANTABILITY OR FITNESS FOR A PARTICULAR
            PURPOSE.
         </p>
      </div>
      <hr class="noprint">
      <div id="rfc.ipr">
         <h1 class="np"><a href="#rfc.ipr">Intellectual Property</a></h1>
         <p>The IETF takes no position regarding the validity or scope of any intellectual property or other rights that might be claimed
            to pertain to the implementation or use of the technology described in this document or the extent to which any license under
            such rights might or might not be available; neither does it represent that it has made any effort to identify any such rights.
            Information on the IETF's procedures with respect to rights in standards-track and standards-related documentation can be
            found in BCP-11. Copies of claims of rights made available for publication and any assurances of licenses to be made available,
            or the result of an attempt made to obtain a general license or permission for the use of such proprietary rights by implementors
            or users of this specification can be obtained from the IETF Secretariat.
         </p>
         <p>The IETF invites any interested party to bring to its attention any copyrights, patents or patent applications, or other proprietary
            rights which may cover technology that may be required to practice this standard. Please address the information to the IETF
            Executive Director.
         </p>
      </div>
      <div>
         <h1>Acknowledgment</h1>
         <p>Funding for the RFC Editor function is currently provided by the Internet Society.</p>
      </div>
   </body>
</html>